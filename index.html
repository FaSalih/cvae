<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="Documentation for the Chemical Variational Autoencoder" /><meta name="author" content="Santiago Miranda" /><link rel="canonical" href="https://ghsanti.github.io/cvae/" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>cvae</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "cvae";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = "/cvae/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> cvae
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">cvae</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="default_config.py/">Default config.py</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="models.py/">Models.py</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="mol_callbacks.py/">Mol callbacks.py</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="mol_utils.py/">Mol utils.py</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="other_callbacks.py/">Other callbacks.py</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="train_vae.py/">Train vae.py</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="vae_utils.py/">Vae utils.py</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="vectorize_data.py/">Vectorize data.py</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">cvae</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">cvae</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ghsanti/cvae/edit/master/docs/index.md">Edit on cvae</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="cvae">cvae</h1>
<p><a href="https://opensource.org/licenses/Apache-2.0"><img alt="License" src="https://img.shields.io/badge/License-Apache_2.0-blue.svg" /></a>
<a href="https://github.com/ghsanti/cvae/actions/workflows/ruff.yaml"><img alt="CI" src="https://github.com/ghsanti/cvae/actions/workflows/ruff.yaml/badge.svg" /></a>
<a href="https://github.com/ghsanti/cvae/actions/workflows/documentation.yaml"><img alt="Docs" src="https://github.com/ghsanti/cvae/actions/workflows/documentation.yaml/badge.svg" /></a></p>
<p>Chemical Variational Autoencoder.</p>
<p><a href="https://github.com/aspuru-guzik-group/chemical_vae/">Based off this great project.</a></p>
<h2 id="api-documentation"><a href="https://ghsanti.github.io/cvae/">API Documentation</a></h2>
<h2 id="install">Install</h2>
<ul>
<li>Set up env</li>
</ul>
<pre><code class="language-bash">git clone https://github.com/ghsanti/cvae cvae #clones into `cvae` folder
# replace clone by fork, if you plan to develop
cd cvae
mamba create -n cvae &quot;python&gt;=3.11.9,&lt;3.12&quot;
mamba init &amp;&amp; source ~/.bashrc
mamba activate cvae
#check your python version now (if wrong, upgrade it.)
python --version
</code></pre>
<ul>
<li>Install dependencies</li>
</ul>
<pre><code class="language-bash">mamba install poetry graphviz -c conda-forge
mamba install nodejs -c conda-forge # only for development
# poetry will install deps and the project respecting conda.
# this also allows running the notebooks and scripts.
poetry install --without dev --sync # unless you want dev deps.
# if poetry fails run the one below
# poetry install --only-main
</code></pre>
<ul>
<li>Run a training:</li>
</ul>
<p>You can modify the program's configuration within <code>scripts/train_vae.py</code></p>
<pre><code class="language-bash">python scripts/train_vae.py
</code></pre>
<p>or</p>
<pre><code class="language-bash">python -m scripts.train_vae
</code></pre>
<h2 id="updates">Updates</h2>
<ul>
<li>Refactored. Uses Keras v3</li>
<li>Removed <code>TerminalGRU</code> (this may result in less precision.)</li>
<li>Supported backends: Tensorflow, Pytorch, Jax.</li>
<li>Typed.</li>
<li>CI.</li>
</ul>
<blockquote>
<p>As long as a layer only uses APIs from the <code>keras.ops</code> namespace (or other Keras namespaces such as <code>keras.activations</code>, <code>keras.random</code>, or <code>keras.layers</code>), then it can be used with any backend – TensorFlow, JAX, or PyTorch.</p>
</blockquote>
<p>By not using backend specifics, it turns the code to multibackend.</p>
<p><a href="https://keras.io/guides/making_new_layers_and_models_via_subclassing/">Source: Keras.</a></p>
<h2 id="upcoming">Upcoming</h2>
<ol>
<li>Currently only the encoder+decoder was tested, not the property predictor. We will test it.</li>
<li>Train with more accuracy (and upload best weights.)</li>
<li>Make it run in a web browser.</li>
<li>Use it to suggest new molecules with specific properties.</li>
<li>Update notebooks</li>
</ol>
<h1 id="attributions">Attributions</h1>
<p>This is a refactor / fork of the original chemical VAE by <a href="https://github.com/aspuru-guzik-group/chemical_vae/">Aspuru-Guzik's Group</a></p>
<p>Part of the original readme (updated) is below (includes authors.)</p>
<hr />
<p>This repository contains the framework and code for constructing a variational autoencoder (VAE) for use with molecular SMILES, as described in <a href="http://pubs.acs.org/doi/abs/10.1021/acscentsci.7b00572">doi:10.1021/acscentsci.7b00572</a>, with preprint at <a href="https://arxiv.org/pdf/1610.02415.pdf">https://arxiv.org/pdf/1610.02415.pdf</a>.</p>
<p>In short, molecular SMILES are encoded into a code vector representation, and can be decoded from the code representation back to molecular SMILES. The autoencoder may also be jointly trained with property prediction to help shape the latent space. The new latent space can then be optimized upon to find the molecules with the most optimized properties of interest.</p>
<p>In our example, we perform encoding/decoding with the ZINC dataset, and shape the latent space on prediction on logP, QED, and SAS properties.</p>
<p>Jupyter notebook is required to run the ipynb examples.
Make sure that the <a href="https://keras.io/backend/">Keras backend</a> is set to use Tensorflow</p>
<h2 id="components">Components</h2>
<ul>
<li><strong>scripts/train_vae.py</strong> : main script for training variational autoencoder</li>
<li><strong>models.py</strong> - Library of models, contains the encoder, decoder and property prediction models.</li>
<li><strong>tgru_k2_gpu.py</strong> - Custom keras layer containing custom teacher forcing/sampling</li>
<li><strong>sampled_rnn_tf.py</strong> - Custom rnn function for tgru_k2_gpu.py, written in tensorflow backend.</li>
<li><strong>hyperparameters/user</strong> - Configuration.</li>
<li><strong>mol_utils.py</strong> - library for parsing SMILES into one-hot encoding and vice versa</li>
<li><strong>mol_callbacks.py</strong> - library containing callbacks used by train_vae.py</li>
<li>Includes Weight_Annealer callback, which is used to update the weight of the KL loss component</li>
<li><strong>vae_utils.py</strong> - utility functions for an autoencoder object, used post processing.</li>
</ul>
<h2 id="authors">Authors:</h2>
<p>This software is written by Jennifer Wei, Benjamin Sanchez-Lengeling, Dennis Sheberla, Rafael Gomez-Bomberelli, and Alan Aspuru-Guzik (alan@aspuru.com).
It is based on the work published in https://arxiv.org/pdf/1610.02415.pdf by</p>
<ul>
<li><a href="http://aspuru.chem.harvard.edu/rafa-gomez-bombarelli/">Rafa Gómez-Bombarelli</a>,</li>
<li><a href="http://aspuru.chem.harvard.edu/jennifer-wei">Jennifer Wei</a>,</li>
<li><a href="https://www.cs.toronto.edu/~duvenaud/">David Duvenaud</a>,</li>
<li><a href="https://jmhl.org/">José Miguel Hernández-Lobato</a>,</li>
<li><a href="">Benjamín Sánchez-Lengeling</a>,</li>
<li><a href="https://www.sheberla.com/">Dennis Sheberla</a>,</li>
<li><a href="http://aspuru.chem.harvard.edu/jorge-aguilera/">Jorge Aguilera-Iparraguirre</a>,</li>
<li><a href="https://www.linkedin.com/in/t1m0thy">Timothy Hirzel</a>,</li>
<li><a href="http://people.seas.harvard.edu/~rpa/'">Ryan P. Adams</a>,</li>
<li><a href="http://aspuru.chem.harvard.edu/about-alan/">Alán Aspuru-Guzik</a></li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="default_config.py/" class="btn btn-neutral float-right" title="Default config.py">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ghsanti/cvae" class="fa fa-code-fork" style="color: #fcfcfc"> cvae</a>
        </span>
    
    
    
      <span><a href="default_config.py/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!--
MkDocs version : 1.6.0
Build Date UTC : 2024-06-25 23:44:58.328530+00:00
-->
